@using Esfa.Recruit.Employer.Web.ViewModels.Part2.Qualifications
@using Esfa.Recruit.Vacancies.Client.Domain.Entities
@model QualificationsViewModel


<div class="grid-row">
    <div class="column-full">

        <h1 class="heading-xlarge small-bottom-margin">@Model.Title</h1>
        <hr>

        @Html.Partial("_ValidationSummary", new ValidationSummaryViewModel { ModelState = ViewData.ModelState, OrderedFieldNames = Model.OrderedFieldNames })

        <form asp-route="@RouteNames.Qualifications_Post">

            <div esfa-validation-marker-for="QualificationType" class="form-group form-group-compound">
                <label asp-for="QualificationType" class="form-label-bold">Type of qualification</label>
                <span esfa-validation-message-for="QualificationType" class="error-message"></span>
                <select asp-for="QualificationType" class="form-control">
                    <option value="">Select from list</option>

                    @foreach (var qualificationType in Model.QualificationTypes)
                    {
                        <option value="@qualificationType" selected="@(Model.QualificationType == @qualificationType)">@qualificationType</option>
                    }
                </select>
            </div>

            <div esfa-validation-marker-for="Subject" class="form-group form-group-compound">
                <label asp-for="Subject" class="form-label-bold">Subject</label>
                <span esfa-validation-message-for="Subject" class="error-message"></span>
                <input asp-for="Subject" value="@Model.Subject" type="text" class="form-control" maxlength="50">
            </div>

            <div esfa-validation-marker-for="Grade" class="form-group" data-bind="parentvalElement:grade">
                <label asp-for="Grade" class="form-label-bold">Grade</label>
                <span esfa-validation-message-for="Grade" class="error-message"></span>
                <input asp-for="Grade" value="@Model.Grade" type="text" class="form-control form-control-1-3" maxlength="30">
            </div>

            <div  esfa-validation-marker-for="Weighting" class="form-group">
                <fieldset class="inline">
                    <legend>
                        <h1 class="form-label-bold">Is this qualification essential?</h1>
                    </legend>
                    <span esfa-validation-message-for="Weighting" class="error-message"></span>
                    <div class="multiple-choice">
                        <input asp-for="Weighting" type="radio" value="@QualificationWeighting.Essential" data-display="@QualificationWeighting.Essential.GetDisplayName()">
                        <label asp-for="Weighting">Yes</label>
                    </div>
                    <div class="multiple-choice">
                        <input asp-for="Weighting" type="radio" value="@QualificationWeighting.Desired" data-display="@QualificationWeighting.Desired.GetDisplayName()">
                        <label asp-for="Weighting">No</label>
                    </div>
                </fieldset>
            </div>

            <div class="form-group">
                <button type="submit" name="AddQualificationAction" id="add-qualification" value="AddQualification" class="button button-secondary">+ Add this qualification</button>
            </div>

            <table id="qualifications-container" style="@(Model.Qualifications.Any() == false ? "display:none" : null)">
                <thead>
                <tr>
                    <th>
                        <span class="heading-span">Qualification</span>
                    </th>
                    <th>
                        <span class="heading-span">Subject</span>
                    </th>
                    <th>
                        <span class="heading-span">Grade</span>
                    </th>
                    <th>
                        <span class="heading-span">Essential or desired</span>
                    </th>
                    <th></th>
                </tr>
                </thead>
                <tbody id="qualifications-summary">
                @for(var i = 0; i < Model.Qualifications.Count; i++)
                {
                    var qualification = Model.Qualifications[i];
                    <tr>
                        <td>@qualification.QualificationType</td>
                        <td>@qualification.Subject</td>
                        <td>@qualification.Grade</td>
                        <td>@qualification.Weighting.GetDisplayName()</td>
                        <td>
                            <input name="Qualifications[@i].QualificationType" type="hidden" value="@qualification.QualificationType" />
                            <input name="Qualifications[@i].Subject" type="hidden" value="@qualification.Subject" />
                            <input name="Qualifications[@i].Grade" type="hidden" value="@qualification.Grade" />
                            <input name="Qualifications[@i].Weighting" type="hidden" value="@qualification.Weighting" />

                            <button type="submit" name="RemoveQualification" class="button-fake-link" value="@i">Remove</button>
                        </td>
                    </tr>
                }
                </tbody>
            </table>

            <br />

            <button type="submit" class="button">Save and continue</button>
            <a asp-route="@RouteNames.Vacancy_Preview_Get" class="button-link">Cancel</a>
        </form>
        <hr>
    </div>

</div>
