@using Esfa.Recruit.Employer.Web.ViewModels.Part2.TrainingProvider
@using Newtonsoft.Json
@model Esfa.Recruit.Employer.Web.ViewModels.SelectTrainingProviderViewModel

<div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">

        <partial name="@PartialNames.ValidationSummary" model='new ValidationSummaryViewModel { ModelState = ViewData.ModelState }' />
        <partial name="@PartialNames.ReviewSummary" for="Review" />

        <h1 class="govuk-heading-xl">
            <span class="govuk-caption-l">@Model.Title</span>
            Choose a training provider
        </h1>

        <form asp-route="@RouteNames.TrainingProvider_Select_Post">

            <p class="govuk-body">
                You will need to use a registered training provider for
                "<span class="govuk-!-font-weight-bold">@Model.SelectedTrainingText</span>"
            </p>

            <noscript>
                <div class="govuk-form-group" id="non-js-search">
                    <span class="govuk-hint">
                        Enter the training provider reference number (UKPRN). You will be able to get this from your training provider The UKPRN must only be 8 digits (For example, 12345678)
                    </span>
                    <span esfa-validation-message-for="Ukprn" class="govuk-error-message"></span>
                    <input asp-for="Ukprn" type="text" maxlength="8" class="govuk-input govuk-input--width-10" />
                </div>
            </noscript>

            <div class="govuk-form-group js-hidden" id="js-search">
                <span class="govuk-hint">
                    Enter the training provider or reference number (UKPRN). <br>
                    UKPRN is 8 numbers. For example 12345678.
                </span>
                <span esfa-validation-message-for="TrainingProviderSearch" class="govuk-error-message"></span>

                <input asp-for="TrainingProviderSearch" type="text" class="govuk-input search-input" />
                
            </div>

            <div class="govuk-form-group">
                <p class="govuk-body">
                    <a asp-route="@RouteNames.TrainingProvider_Select_Get" asp-route-clear="true" class="govuk-link">Clear search</a>
                </p>
                <input type="hidden" name="SelectionType" id="selection-type" value="@TrainingProviderSelectionType.Ukprn" />
                <input type="submit" value="Continue" esfa-automation="btn-continue" class="govuk-button" />
                <a asp-route="@RouteNames.Vacancy_Preview_Get" esfa-automation="link-cancel" class="govuk-link das-button-link">Cancel</a>
            </div>
        </form>
    </div>
</div>

@section HeadCSS
{
    <link asp-append-version="true" rel="stylesheet" media="screen" href="/lib/accessible-autocomplete/style.css" />
}

@section FooterJS
{
    <script asp-append-version="true" src="/lib/accessible-autocomplete/accessible-autocomplete.min.js"></script>
    <script asp-append-version="true" src="/javascripts/esfa-training-provider-suggestions/searchSuggestionsService.js"></script>

    <script nws-csp-add-nonce="true">
        $("#js-search").removeClass("js-hidden");
        $("#selection-type").val("@TrainingProviderSelectionType.TrainingProviderSearch");

        var providers = @(Html.Raw(JsonConvert.SerializeObject(Model.TrainingProviders)));

        searchSuggestions.init($("#@Html.IdFor(m => m.TrainingProviderSearch)"), providers);
    </script>
}
