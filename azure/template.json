{
        "$schema":    "https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json",
        "contentVersion":    "1.0.0.0",
        "parameters":    {
                                             "resourceEnvironmentName":    {
                                                                                                             "type":    "string"
                                                                                                     },
                                             "serviceName":    {
                                                                                     "type":    "string"
                                                                             },
                                             "tags":    {
                                                                        "type":    "object"
                                                                },
                                             "resourceGroupLocation":    {
                                                                                                         "type":    "string"
                                                                                                 },
                                             "jobsAspSize":    {
                                                                                     "type":    "string",
                                                                                     "allowedValues":    [
                                                                                                                                 "1",
                                                                                                                                 "2",
                                                                                                                                 "3"
                                                                                                                         ],
                                                                                     "defaultValue":    "1"
                                                                             },
                                             "jobsAspInstances":    {
                                                                                                "type":    "int",
                                                                                                "defaultValue":    1
                                                                                        },
                                             "jobsAspTier":    {
                                                                                     "type":    "string",
                                                                                     "defaultValue":    "Standard"
                                                                             },
                                             "environmentName":    {
                                                                                             "type":    "string"
                                                                                     },
                                             "ConfigurationStorageConnectionString":    {
                                                                                                                                        "type":    "securestring"
                                                                                                                                },
                                             "LoggingRedisConnectionString":    {
                                                                                                                        "type":    "securestring"
                                                                                                                },
                                             "sharedFrontEndAppServicePlanName":    {
                                                                                                                                "type":    "string"
                                                                                                                        },
                                             "sharedFrontEndSubnetResourceId":    {
                                                                                                                            "type":    "string"
                                                                                                                    },
                                             "sharedEnvResourceGroup":    {
                                                                                                            "type":    "string"
                                                                                                    },
                                             "employerCustomHostname":    {
                                                                                                            "type":    "string"
                                                                                                    },
                                             "employerKeyvaultCertificateName":    {
                                                                                                                             "type":    "string"
                                                                                                                     },
                                             "qaAppCustomHostname":    {
                                                                                                     "type":    "string"
                                                                                             },
                                             "qaAppKeyvaultCertificateName":    {
                                                                                                                        "type":    "string"
                                                                                                                },
                                             "providerCustomHostname":    {
                                                                                                            "type":    "string"
                                                                                                    },
                                             "providerKeyvaultCertificateName":    {
                                                                                                                             "type":    "string"
                                                                                                                     },
                                             "cosmosDbSubnetResourceIdList":    {
                                                                                                                        "type":    "array",
                                                                                                                        "defaultValue":    [

                                                                                                                                                         ]
                                                                                                                },
                                             "cosmosDbIpRangeFilter":    {
                                                                                                         "type":    "string",
                                                                                                         "defaultValue":    ""
                                                                                                 },
                                             "cosmosDbName":    {
                                                                                        "type":    "string"
                                                                                },
                                             "cosmosDatabase":    {
                                                                                            "type":    "string"
                                                                                    },
                                             "containerArray":    {
                                                                                            "type":    "array"
                                                                                    },
                                             "sharedKeyvaultName":    {
                                                                                                    "type":    "string"
                                                                                            },
                                             "sharedManagementResourceGroup":    {
                                                                                                                         "type":    "string"
                                                                                                                 },
                                             "frontEndAccessRestrictions":    {
                                                                                                                    "type":    "array"
                                                                                                            },
                                             "workerAccessRestrictions":    {
                                                                                                                "type":    "array"
                                                                                                        },
                                             "sharedApimResourceGroup":    {
                                                                                                             "type":    "string"
                                                                                                     },
                                             "sharedApimName":    {
                                                                                            "type":    "string"
                                                                                    },
                                             "cosmosDbServerVersion":    {
                                                                                                         "type":    "string"
                                                                                                 },
                                             "sharedEnvVirtualNetworkName":    {
                                                                                                                     "type":    "string"
                                                                                                             },
                                             "webjobSubnetObject":    {
                                                                                                    "type":    "object"
                                                                                            },
                                             "subnetServiceEndpointList":    {
                                                                                                                 "type":    "array"
                                                                                                         },
                                             "subnetDelegations":    {
                                                                                                 "type":    "array"
                                                                                         },
                                             "sharedServiceBusName":    {
                                                                                                        "type":    "string"
                                                                                                },
                                             "apiCustomHostname":    {
                                                                                                 "type":    "string"
                                                                                         },
                                             "apiKeyvaultCertificateName":    {
                                                                                                                    "type":    "string"
                                                                                                            },
                                             "wafOutboundIPAddresses":    {
                                                                                                            "type":    "array"
                                                                                                    },
                                             "sharedBackEndAppServicePlanName":    {
                                                                                                                             "type":    "string"
                                                                                                                     },
                                             "sharedBackEndSubnetResourceId":    {
                                                                                                                         "type":    "string"
                                                                                                                 },
                                             "sharedSQLServerName":    {
                                                                                                     "type":    "string"
                                                                                             },
                                             "logAnalyticsSubscriptionId":    {
                                                                                                                    "type":    "string",
                                                                                                                    "defaultValue":    "[subscription().subscriptionId]"
                                                                                                            },
                                             "logAnalyticsWorkspaceName":    {
                                                                                                                 "type":    "string"
                                                                                                         },
                                             "cdnUrl":    {
                                                                            "type":    "string"
                                                                    },
                                             "utcValue":    {
                                                                                "type":    "string",
                                                                                "defaultValue":    "[utcNow(\u0027yyMMddHHmmss\u0027)]"
                                                                        },
                                             "stubAuth":    {
                                                                                "type":    "string"
                                                                        },
                                             "minimumTlsVersion":    {
                                                                                                 "type":    "string",
                                                                                                 "defaultValue":    "TLS1_2"
                                                                                         },
                                             "EnableRouteTableAssociation":    {
                                                                                                                     "type":    "bool",
                                                                                                                     "defaultValue":    false,
                                                                                                                     "metadata":    {
                                                                                                                                                        "description":    "Determines whether to enable route table association on subnet"
                                                                                                                                                }
                                                                                                             },
                                             "SharedRouteTableName":    {
                                                                                                        "type":    "string",
                                                                                                        "metadata":    {
                                                                                                                                         "description":    "Determines whether to enable route table association on subnet"
                                                                                                                                 }
                                                                                                }
                                     },
        "variables":    {
                                            "deploymentUrlBase":    "https://raw.githubusercontent.com/SkillsFundingAgency/das-platform-building-blocks/master/templates/",
                                            "resourceNamePrefix":    "[toLower(concat(\u0027das-\u0027, parameters(\u0027resourceEnvironmentName\u0027),\u0027-\u0027, parameters(\u0027serviceName\u0027)))]",
                                            "resourceGroupName":    "[concat(variables(\u0027resourceNamePrefix\u0027),\u0027-rg\u0027)]",
                                            "webJobAppServicePlanName":    "[concat(variables(\u0027resourceNamePrefix\u0027),\u0027-webjob-asp\u0027)]",
                                            "employerRecruitAppServiceName":    "[concat(variables(\u0027resourceNamePrefix\u0027), \u0027-as\u0027)]",
                                            "providerRecruitAppServiceName":    "[concat(variables(\u0027resourceNamePrefix\u0027), \u0027-pr-as\u0027)]",
                                            "qaAppServiceName":    "[concat(variables(\u0027resourceNamePrefix\u0027), \u0027-qa-as\u0027)]",
                                            "webjobAppServiceName":    "[concat(variables(\u0027resourceNamePrefix\u0027), \u0027-webjob-as\u0027)]",
                                            "storageAccountName":    "[toLower(concat(\u0027das\u0027, parameters(\u0027resourceEnvironmentName\u0027), parameters(\u0027serviceName\u0027), \u0027str\u0027))]",
                                            "apiAppServiceName":    "[concat(variables(\u0027resourceNamePrefix\u0027), \u0027api-as\u0027)]",
                                            "apiConfigNames":    "SFA.DAS.Recruit.Api,SFA.DAS.Encoding",
                                            "providerWebConfigNames":    "SFA.DAS.Recruit.Provider,SFA.DAS.Provider.DfeSignIn,SFA.DAS.Encoding",
                                            "employerWebConfigNames":    "SFA.DAS.Recruit.Employer,SFA.DAS.Employer.GovSignIn,SFA.DAS.Encoding",
                                            "qaConfigNames":    "SFA.DAS.Recruit.QA,SFA.DAS.Provider.DfeSignIn,SFA.DAS.Encoding",
                                            "jobsConfigNames":    "SFA.DAS.Recruit.Jobs,SFA.DAS.Encoding",
                                            "routeTableId":    {
                                                                                     "id":    "[resourceId(subscription().subscriptionId, parameters(\u0027sharedEnvResourceGroup\u0027), \u0027Microsoft.Network/routeTables\u0027, parameters(\u0027SharedRouteTableName\u0027))]"
                                                                             },
                                            "emptyObject":    {

                                                                            }
                                    },
        "resources":    [
                                            {
                                                    "apiVersion":    "2020-10-01",
                                                    "name":    "[variables(\u0027resourceGroupName\u0027)]",
                                                    "type":    "Microsoft.Resources/resourceGroups",
                                                    "location":    "[parameters(\u0027resourceGroupLocation\u0027)]",
                                                    "tags":    "[parameters(\u0027tags\u0027)]",
                                                    "properties":    {

                                                                                 }
                                            },
                                            {
                                                    "apiVersion":    "2020-10-01",
                                                    "name":    "[concat(\u0027employer-recruit-app-insights-\u0027, parameters(\u0027utcValue\u0027))]",
                                                    "type":    "Microsoft.Resources/deployments",
                                                    "resourceGroup":    "[variables(\u0027resourceGroupName\u0027)]",
                                                    "properties":    {
                                                                                         "mode":    "Incremental",
                                                                                         "templateLink":    {
                                                                                                                                    "uri":    "[concat(variables(\u0027deploymentUrlBase\u0027),\u0027application-insights.json\u0027)]",
                                                                                                                                    "contentVersion":    "1.0.0.0"
                                                                                                                            },
                                                                                         "parameters":    {
                                                                                                                                "appInsightsName":    {
                                                                                                                                                                                "value":    "[variables(\u0027employerRecruitAppServiceName\u0027)]"
                                                                                                                                                                        },
                                                                                                                                "attachedService":    {
                                                                                                                                                                                "value":    "[variables(\u0027employerRecruitAppServiceName\u0027)]"
                                                                                                                                                                        },
                                                                                                                                "logAnalyticsWorkspaceId":    {
                                                                                                                                                                                                "value":    "[resourceId(parameters(\u0027logAnalyticsSubscriptionId\u0027),parameters(\u0027sharedManagementResourceGroup\u0027),\u0027Microsoft.OperationalInsights/workspaces\u0027,parameters(\u0027logAnalyticsWorkspaceName\u0027))]"
                                                                                                                                                                                        }
                                                                                                                        }
                                                                                 },
                                                    "dependsOn":    [
                                                                                        "[variables(\u0027resourceGroupName\u0027)]"
                                                                                ]
                                            },
                                            {
                                                    "apiVersion":    "2020-10-01",
                                                    "name":    "[concat(\u0027qa-app-insights-\u0027, parameters(\u0027utcValue\u0027))]",
                                                    "type":    "Microsoft.Resources/deployments",
                                                    "resourceGroup":    "[variables(\u0027resourceGroupName\u0027)]",
                                                    "properties":    {
                                                                                         "mode":    "Incremental",
                                                                                         "templateLink":    {
                                                                                                                                    "uri":    "[concat(variables(\u0027deploymentUrlBase\u0027),\u0027application-insights.json\u0027)]",
                                                                                                                                    "contentVersion":    "1.0.0.0"
                                                                                                                            },
                                                                                         "parameters":    {
                                                                                                                                "appInsightsName":    {
                                                                                                                                                                                "value":    "[variables(\u0027qaAppServiceName\u0027)]"
                                                                                                                                                                        },
                                                                                                                                "attachedService":    {
                                                                                                                                                                                "value":    "[variables(\u0027qaAppServiceName\u0027)]"
                                                                                                                                                                        },
                                                                                                                                "logAnalyticsWorkspaceId":    {
                                                                                                                                                                                                "value":    "[resourceId(parameters(\u0027logAnalyticsSubscriptionId\u0027),parameters(\u0027sharedManagementResourceGroup\u0027),\u0027Microsoft.OperationalInsights/workspaces\u0027,parameters(\u0027logAnalyticsWorkspaceName\u0027))]"
                                                                                                                                                                                        }
                                                                                                                        }
                                                                                 },
                                                    "dependsOn":    [
                                                                                        "[variables(\u0027resourceGroupName\u0027)]"
                                                                                ]
                                            },
                                            {
                                                    "apiVersion":    "2020-10-01",
                                                    "name":    "[concat(\u0027provider-recruit-app-insights-\u0027, parameters(\u0027utcValue\u0027))]",
                                                    "type":    "Microsoft.Resources/deployments",
                                                    "resourceGroup":    "[variables(\u0027resourceGroupName\u0027)]",
                                                    "properties":    {
                                                                                         "mode":    "Incremental",
                                                                                         "templateLink":    {
                                                                                                                                    "uri":    "[concat(variables(\u0027deploymentUrlBase\u0027),\u0027application-insights.json\u0027)]",
                                                                                                                                    "contentVersion":    "1.0.0.0"
                                                                                                                            },
                                                                                         "parameters":    {
                                                                                                                                "appInsightsName":    {
                                                                                                                                                                                "value":    "[variables(\u0027providerRecruitAppServiceName\u0027)]"
                                                                                                                                                                        },
                                                                                                                                "attachedService":    {
                                                                                                                                                                                "value":    "[variables(\u0027providerRecruitAppServiceName\u0027)]"
                                                                                                                                                                        },
                                                                                                                                "logAnalyticsWorkspaceId":    {
                                                                                                                                                                                                "value":    "[resourceId(parameters(\u0027logAnalyticsSubscriptionId\u0027),parameters(\u0027sharedManagementResourceGroup\u0027),\u0027Microsoft.OperationalInsights/workspaces\u0027,parameters(\u0027logAnalyticsWorkspaceName\u0027))]"
                                                                                                                                                                                        }
                                                                                                                        }
                                                                                 },
                                                    "dependsOn":    [
                                                                                        "[variables(\u0027resourceGroupName\u0027)]"
                                                                                ]
                                            },
                                            {
                                                    "apiVersion":    "2020-10-01",
                                                    "name":    "[concat(\u0027webjob-recruit-app-insights-\u0027, parameters(\u0027utcValue\u0027))]",
                                                    "type":    "Microsoft.Resources/deployments",
                                                    "resourceGroup":    "[variables(\u0027resourceGroupName\u0027)]",
                                                    "properties":    {
                                                                                         "mode":    "Incremental",
                                                                                         "templateLink":    {
                                                                                                                                    "uri":    "[concat(variables(\u0027deploymentUrlBase\u0027),\u0027application-insights.json\u0027)]",
                                                                                                                                    "contentVersion":    "1.0.0.0"
                                                                                                                            },
                                                                                         "parameters":    {
                                                                                                                                "appInsightsName":    {
                                                                                                                                                                                "value":    "[variables(\u0027webjobAppServiceName\u0027)]"
                                                                                                                                                                        },
                                                                                                                                "attachedService":    {
                                                                                                                                                                                "value":    "[variables(\u0027webjobAppServiceName\u0027)]"
                                                                                                                                                                        },
                                                                                                                                "logAnalyticsWorkspaceId":    {
                                                                                                                                                                                                "value":    "[resourceId(parameters(\u0027logAnalyticsSubscriptionId\u0027),parameters(\u0027sharedManagementResourceGroup\u0027),\u0027Microsoft.OperationalInsights/workspaces\u0027,parameters(\u0027logAnalyticsWorkspaceName\u0027))]"
                                                                                                                                                                                        }
                                                                                                                        }
                                                                                 },
                                                    "dependsOn":    [
                                                                                        "[variables(\u0027resourceGroupName\u0027)]"
                                                                                ]
                                            },
                                            {
                                                    "apiVersion":    "2020-10-01",
                                                    "name":    "[concat(\u0027cosmos-db-\u0027, parameters(\u0027utcValue\u0027))]",
                                                    "type":    "Microsoft.Resources/deployments",
                                                    "resourceGroup":    "[variables(\u0027resourceGroupName\u0027)]",
                                                    "properties":    {
                                                                                         "mode":    "Incremental",
                                                                                         "templateLink":    {
                                                                                                                                    "uri":    "[concat(variables(\u0027deploymentUrlBase\u0027),\u0027cosmos-db.json\u0027)]",
                                                                                                                                    "contentVersion":    "1.0.0.0"
                                                                                                                            },
                                                                                         "parameters":    {
                                                                                                                                "cosmosDbName":    {
                                                                                                                                                                         "value":    "[parameters(\u0027cosmosDbName\u0027)]"
                                                                                                                                                                 },
                                                                                                                                "cosmosDbType":    {
                                                                                                                                                                         "value":    "MongoDB"
                                                                                                                                                                 },
                                                                                                                                "defaultConsistencyLevel":    {
                                                                                                                                                                                                "value":    "Strong"
                                                                                                                                                                                        },
                                                                                                                                "subnetResourceIdList":    {
                                                                                                                                                                                         "value":    "[parameters(\u0027cosmosDbSubnetResourceIdList\u0027)]"
                                                                                                                                                                                 },
                                                                                                                                "ipRangeFilter":    {
                                                                                                                                                                            "value":    "[parameters(\u0027cosmosDbIpRangeFilter\u0027)]"
                                                                                                                                                                    },
                                                                                                                                "serverVersion":    {
                                                                                                                                                                            "value":    "[parameters(\u0027cosmosDbServerVersion\u0027)]"
                                                                                                                                                                    },
                                                                                                                                "logAnalyticsWorkspaceName":    {
                                                                                                                                                                                                    "value":    "[parameters(\u0027logAnalyticsWorkspaceName\u0027)]"
                                                                                                                                                                                            },
                                                                                                                                "logAnalyticsWorkspaceResourceGroupName":    {
                                                                                                                                                                                                                             "value":    "[parameters(\u0027sharedManagementResourceGroup\u0027)]"
                                                                                                                                                                                                                     }
                                                                                                                        }
                                                                                 },
                                                    "dependsOn":    [
                                                                                        "[variables(\u0027resourceGroupName\u0027)]"
                                                                                ]
                                            },
                                            {
                                                    "apiVersion":    "2020-10-01",
                                                    "name":    "[concat(\u0027cosmos-db-database-deployment-\u0027, parameters(\u0027utcValue\u0027))]",
                                                    "dependsOn":    [
                                                                                        "[concat(\u0027cosmos-db-\u0027, parameters(\u0027utcValue\u0027))]"
                                                                                ],
                                                    "type":    "Microsoft.Resources/deployments",
                                                    "resourceGroup":    "[variables(\u0027resourceGroupName\u0027)]",
                                                    "properties":    {
                                                                                         "mode":    "Incremental",
                                                                                         "templateLink":    {
                                                                                                                                    "uri":    "[concat(variables(\u0027deploymentUrlBase\u0027),\u0027cosmos-db-database.json\u0027)]",
                                                                                                                                    "contentVersion":    "1.0.0.0"
                                                                                                                            },
                                                                                         "parameters":    {
                                                                                                                                "cosmosDbAccountName":    {
                                                                                                                                                                                        "value":    "[parameters(\u0027cosmosDbName\u0027)]"
                                                                                                                                                                                },
                                                                                                                                "cosmosDatabase":    {
                                                                                                                                                                             "value":    "[parameters(\u0027cosmosDatabase\u0027)]"
                                                                                                                                                                     },
                                                                                                                                "cosmosDBType":    {
                                                                                                                                                                         "value":    "MongoDB"
                                                                                                                                                                 }
                                                                                                                        }
                                                                                 }
                                            },
                                            {
                                                    "apiVersion":    "2020-10-01",
                                                    "name":    "[concat(\u0027cosmos-db-container-\u0027, parameters(\u0027containerArray\u0027)[copyIndex()].containerName, \u0027-\u0027, parameters(\u0027utcValue\u0027))]",
                                                    "dependsOn":    [
                                                                                        "[concat(\u0027cosmos-db-database-deployment-\u0027, parameters(\u0027utcValue\u0027))]"
                                                                                ],
                                                    "type":    "Microsoft.Resources/deployments",
                                                    "resourceGroup":    "[variables(\u0027resourceGroupName\u0027)]",
                                                    "condition":    "[greater(length(parameters(\u0027containerArray\u0027)), 0)]",
                                                    "properties":    {
                                                                                         "mode":    "Incremental",
                                                                                         "templateLink":    {
                                                                                                                                    "uri":    "[concat(variables(\u0027deploymentUrlBase\u0027),\u0027cosmos-db-container.json\u0027)]",
                                                                                                                                    "contentVersion":    "1.0.0.0"
                                                                                                                            },
                                                                                         "parameters":    {
                                                                                                                                "cosmosDbAccountName":    {
                                                                                                                                                                                        "value":    "[parameters(\u0027cosmosDbName\u0027)]"
                                                                                                                                                                                },
                                                                                                                                "cosmosDatabase":    {
                                                                                                                                                                             "value":    "[parameters(\u0027cosmosDatabase\u0027)]"
                                                                                                                                                                     },
                                                                                                                                "cosmosDBType":    {
                                                                                                                                                                         "value":    "MongoDB"
                                                                                                                                                                 },
                                                                                                                                "containerName":    {
                                                                                                                                                                            "value":    "[parameters(\u0027containerArray\u0027)[copyIndex()].containerName]"
                                                                                                                                                                    },
                                                                                                                                "partitionKey":    {
                                                                                                                                                                         "value":    "[parameters(\u0027containerArray\u0027)[copyIndex()].partitionKey]"
                                                                                                                                                                 }
                                                                                                                        }
                                                                                 },
                                                    "copy":    {
                                                                             "name":    "containercopy",
                                                                             "count":    "[length(parameters(\u0027containerArray\u0027))]"
                                                                     }
                                            },
                                            {
                                                    "apiVersion":    "2020-10-01",
                                                    "name":    "[concat(\u0027cdb-contnr-settings-\u0027, parameters(\u0027containerArray\u0027)[copyIndex()].containerName, \u0027-\u0027, parameters(\u0027utcValue\u0027))]",
                                                    "dependsOn":    [
                                                                                        "[concat(\u0027cosmos-db-container-\u0027, parameters(\u0027containerArray\u0027)[copyIndex()].containerName, \u0027-\u0027, parameters(\u0027utcValue\u0027))]"
                                                                                ],
                                                    "type":    "Microsoft.Resources/deployments",
                                                    "resourceGroup":    "[variables(\u0027resourceGroupName\u0027)]",
                                                    "condition":    "[greater(length(parameters(\u0027containerArray\u0027)), 0)]",
                                                    "properties":    {
                                                                                         "mode":    "Incremental",
                                                                                         "templateLink":    {
                                                                                                                                    "uri":    "[concat(variables(\u0027deploymentUrlBase\u0027),\u0027cosmos-db-container-settings.json\u0027)]",
                                                                                                                                    "contentVersion":    "1.0.0.0"
                                                                                                                            },
                                                                                         "parameters":    {
                                                                                                                                "cosmosDbAccountName":    {
                                                                                                                                                                                        "value":    "[parameters(\u0027cosmosDbName\u0027)]"
                                                                                                                                                                                },
                                                                                                                                "cosmosDatabase":    {
                                                                                                                                                                             "value":    "[parameters(\u0027cosmosDatabase\u0027)]"
                                                                                                                                                                     },
                                                                                                                                "cosmosDBType":    {
                                                                                                                                                                         "value":    "MongoDB"
                                                                                                                                                                 },
                                                                                                                                "containerName":    {
                                                                                                                                                                            "value":    "[parameters(\u0027containerArray\u0027)[copyIndex()].containerName]"
                                                                                                                                                                    },
                                                                                                                                "throughput":    {
                                                                                                                                                                     "value":    "[parameters(\u0027containerArray\u0027)[copyIndex()].throughput]"
                                                                                                                                                             },
                                                                                                                                "maxThroughput":    {
                                                                                                                                                                            "value":    "[parameters(\u0027containerArray\u0027)[copyIndex()].maxThroughput]"
                                                                                                                                                                    }
                                                                                                                        }
                                                                                 },
                                                    "copy":    {
                                                                             "name":    "containercopy",
                                                                             "count":    "[length(parameters(\u0027containerArray\u0027))]"
                                                                     }
                                            },
                                            {
                                                    "condition":    "[greater(length(parameters(\u0027EmployerCustomHostname\u0027)), 0)]",
                                                    "apiVersion":    "2020-10-01",
                                                    "name":    "[concat(\u0027employer-recruit-app-service-certificate-\u0027, parameters(\u0027utcValue\u0027))]",
                                                    "resourceGroup":    "[parameters(\u0027sharedEnvResourceGroup\u0027)]",
                                                    "type":    "Microsoft.Resources/deployments",
                                                    "properties":    {
                                                                                         "mode":    "Incremental",
                                                                                         "templateLink":    {
                                                                                                                                    "uri":    "[concat(variables(\u0027deploymentUrlBase\u0027),\u0027app-service-certificate.json\u0027)]",
                                                                                                                                    "contentVersion":    "1.0.0.0"
                                                                                                                            },
                                                                                         "parameters":    {
                                                                                                                                "keyVaultCertificateName":    {
                                                                                                                                                                                                "value":    "[parameters(\u0027EmployerKeyvaultCertificateName\u0027)]"
                                                                                                                                                                                        },
                                                                                                                                "keyVaultName":    {
                                                                                                                                                                         "value":    "[parameters(\u0027sharedKeyvaultName\u0027)]"
                                                                                                                                                                 },
                                                                                                                                "keyVaultResourceGroup":    {
                                                                                                                                                                                            "value":    "[parameters(\u0027sharedManagementResourceGroup\u0027)]"
                                                                                                                                                                                    }
                                                                                                                        }
                                                                                 }
                                            },
                                            {
                                                    "apiVersion":    "2020-10-01",
                                                    "name":    "[concat(\u0027employer-recruit-app-service-\u0027, parameters(\u0027utcValue\u0027))]",
                                                    "type":    "Microsoft.Resources/deployments",
                                                    "resourceGroup":    "[variables(\u0027resourceGroupName\u0027)]",
                                                    "properties":    {
                                                                                         "mode":    "Incremental",
                                                                                         "templateLink":    {
                                                                                                                                    "uri":    "[concat(variables(\u0027deploymentUrlBase\u0027),\u0027app-service-v2.json\u0027)]",
                                                                                                                                    "contentVersion":    "1.0.0.0"
                                                                                                                            },
                                                                                         "parameters":    {
                                                                                                                                "appServiceName":    {
                                                                                                                                                                             "value":    "[variables(\u0027employerRecruitAppServiceName\u0027)]"
                                                                                                                                                                     },
                                                                                                                                "appServicePlanName":    {
                                                                                                                                                                                     "value":    "[parameters(\u0027sharedFrontEndAppServicePlanName\u0027)]"
                                                                                                                                                                             },
                                                                                                                                "appServicePlanResourceGroup":    {
                                                                                                                                                                                                        "value":    "[parameters(\u0027sharedEnvResourceGroup\u0027)]"
                                                                                                                                                                                                },
                                                                                                                                "subnetResourceId":    {
                                                                                                                                                                                 "value":    "[parameters(\u0027sharedFrontEndSubnetResourceId\u0027)]"
                                                                                                                                                                         },
                                                                                                                                "appServiceAppSettings":    {
                                                                                                                                                                                            "value":    {
                                                                                                                                                                                                                        "array":    [
                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                            "name":    "ConfigurationStorageConnectionString",
                                                                                                                                                                                                                                                            "value":    "[parameters(\u0027configurationStorageConnectionString\u0027)]"
                                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                            "name":    "APPLICATIONINSIGHTS_CONNECTION_STRING",
                                                                                                                                                                                                                                                            "value":    "[reference(concat(\u0027employer-recruit-app-insights-\u0027, parameters(\u0027utcValue\u0027))).outputs.ConnectionString.value]"
                                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                            "name":    "Environment",
                                                                                                                                                                                                                                                            "value":    "[toUpper(parameters(\u0027environmentName\u0027))]"
                                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                            "name":    "ResourceEnvironmentName",
                                                                                                                                                                                                                                                            "value":    "[toUpper(parameters(\u0027resourceEnvironmentName\u0027))]"
                                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                            "name":    "LoggingRedisConnectionString",
                                                                                                                                                                                                                                                            "value":    "[parameters(\u0027loggingRedisConnectionString\u0027)]"
                                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                            "name":    "Cdn:Url",
                                                                                                                                                                                                                                                            "value":    "[parameters(\u0027cdnUrl\u0027)]"
                                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                            "name":    "StubAuth",
                                                                                                                                                                                                                                                            "value":    "[parameters(\u0027stubAuth\u0027)]"
                                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                            "name":    "ConfigNames",
                                                                                                                                                                                                                                                            "value":    "[variables(\u0027employerWebConfigNames\u0027)]"
                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                            ]
                                                                                                                                                                                                                }
                                                                                                                                                                                    },
                                                                                                                                "customHostName":    {
                                                                                                                                                                             "value":    "[parameters(\u0027EmployerCustomHostname\u0027)]"
                                                                                                                                                                     },
                                                                                                                                "certificateThumbprint":    {
                                                                                                                                                                                            "value":    "[if(greater(length(parameters(\u0027EmployerCustomHostname\u0027)), 0), reference(concat(\u0027employer-recruit-app-service-certificate-\u0027, parameters(\u0027utcValue\u0027)), \u00272018-11-01\u0027).outputs.certificateThumbprint.value, \u0027\u0027)]"
                                                                                                                                                                                    },
                                                                                                                                "ipSecurityRestrictions":    {
                                                                                                                                                                                             "value":    "[parameters(\u0027frontEndAccessRestrictions\u0027)]"
                                                                                                                                                                                     }
                                                                                                                        }
                                                                                 }
                                            },
                                            {
                                                    "condition":    "[greater(length(parameters(\u0027QAAppCustomHostname\u0027)), 0)]",
                                                    "apiVersion":    "2020-10-01",
                                                    "name":    "[concat(\u0027qa-app-service-certificate-\u0027, parameters(\u0027utcValue\u0027))]",
                                                    "resourceGroup":    "[parameters(\u0027sharedEnvResourceGroup\u0027)]",
                                                    "type":    "Microsoft.Resources/deployments",
                                                    "properties":    {
                                                                                         "mode":    "Incremental",
                                                                                         "templateLink":    {
                                                                                                                                    "uri":    "[concat(variables(\u0027deploymentUrlBase\u0027),\u0027app-service-certificate.json\u0027)]",
                                                                                                                                    "contentVersion":    "1.0.0.0"
                                                                                                                            },
                                                                                         "parameters":    {
                                                                                                                                "keyVaultCertificateName":    {
                                                                                                                                                                                                "value":    "[parameters(\u0027QAAppKeyvaultCertificateName\u0027)]"
                                                                                                                                                                                        },
                                                                                                                                "keyVaultName":    {
                                                                                                                                                                         "value":    "[parameters(\u0027sharedKeyvaultName\u0027)]"
                                                                                                                                                                 },
                                                                                                                                "keyVaultResourceGroup":    {
                                                                                                                                                                                            "value":    "[parameters(\u0027sharedManagementResourceGroup\u0027)]"
                                                                                                                                                                                    }
                                                                                                                        }
                                                                                 }
                                            },
                                            {
                                                    "apiVersion":    "2020-10-01",
                                                    "name":    "[concat(\u0027qa-app-service-\u0027, parameters(\u0027utcValue\u0027))]",
                                                    "type":    "Microsoft.Resources/deployments",
                                                    "resourceGroup":    "[variables(\u0027resourceGroupName\u0027)]",
                                                    "properties":    {
                                                                                         "mode":    "Incremental",
                                                                                         "templateLink":    {
                                                                                                                                    "uri":    "[concat(variables(\u0027deploymentUrlBase\u0027),\u0027app-service-v2.json\u0027)]",
                                                                                                                                    "contentVersion":    "1.0.0.0"
                                                                                                                            },
                                                                                         "parameters":    {
                                                                                                                                "appServiceName":    {
                                                                                                                                                                             "value":    "[variables(\u0027qaAppServiceName\u0027)]"
                                                                                                                                                                     },
                                                                                                                                "appServicePlanName":    {
                                                                                                                                                                                     "value":    "[parameters(\u0027sharedFrontEndAppServicePlanName\u0027)]"
                                                                                                                                                                             },
                                                                                                                                "appServicePlanResourceGroup":    {
                                                                                                                                                                                                        "value":    "[parameters(\u0027sharedEnvResourceGroup\u0027)]"
                                                                                                                                                                                                },
                                                                                                                                "subnetResourceId":    {
                                                                                                                                                                                 "value":    "[parameters(\u0027sharedFrontEndSubnetResourceId\u0027)]"
                                                                                                                                                                         },
                                                                                                                                "appServiceAppSettings":    {
                                                                                                                                                                                            "value":    {
                                                                                                                                                                                                                        "array":    [
                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                            "name":    "ConfigurationStorageConnectionString",
                                                                                                                                                                                                                                                            "value":    "[parameters(\u0027configurationStorageConnectionString\u0027)]"
                                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                            "name":    "APPLICATIONINSIGHTS_CONNECTION_STRING",
                                                                                                                                                                                                                                                            "value":    "[reference(concat(\u0027qa-app-insights-\u0027, parameters(\u0027utcValue\u0027))).outputs.ConnectionString.value]"
                                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                            "name":    "Environment",
                                                                                                                                                                                                                                                            "value":    "[toUpper(parameters(\u0027environmentName\u0027))]"
                                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                            "name":    "LoggingRedisConnectionString",
                                                                                                                                                                                                                                                            "value":    "[parameters(\u0027loggingRedisConnectionString\u0027)]"
                                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                            "name":    "Cdn:Url",
                                                                                                                                                                                                                                                            "value":    "[parameters(\u0027cdnUrl\u0027)]"
                                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                            "name":    "ResourceEnvironmentName",
                                                                                                                                                                                                                                                            "value":    "[toUpper(parameters(\u0027resourceEnvironmentName\u0027))]"
                                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                            "name":    "ConfigNames",
                                                                                                                                                                                                                                                            "value":    "[variables(\u0027qaConfigNames\u0027)]"
                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                            ]
                                                                                                                                                                                                                }
                                                                                                                                                                                    },
                                                                                                                                "customHostName":    {
                                                                                                                                                                             "value":    "[parameters(\u0027QAAppCustomHostname\u0027)]"
                                                                                                                                                                     },
                                                                                                                                "certificateThumbprint":    {
                                                                                                                                                                                            "value":    "[if(greater(length(parameters(\u0027EmployerCustomHostname\u0027)), 0), reference(concat(\u0027qa-app-service-certificate-\u0027, parameters(\u0027utcValue\u0027)), \u00272018-11-01\u0027).outputs.certificateThumbprint.value, \u0027\u0027)]"
                                                                                                                                                                                    },
                                                                                                                                "ipSecurityRestrictions":    {
                                                                                                                                                                                             "value":    "[parameters(\u0027frontEndAccessRestrictions\u0027)]"
                                                                                                                                                                                     }
                                                                                                                        }
                                                                                 }
                                            },
                                            {
                                                    "condition":    "[greater(length(parameters(\u0027ProviderKeyvaultCertificateName\u0027)), 0)]",
                                                    "apiVersion":    "2020-10-01",
                                                    "name":    "[concat(\u0027provider-recruit-app-service-certificate-\u0027, parameters(\u0027utcValue\u0027))]",
                                                    "resourceGroup":    "[parameters(\u0027sharedEnvResourceGroup\u0027)]",
                                                    "type":    "Microsoft.Resources/deployments",
                                                    "properties":    {
                                                                                         "mode":    "Incremental",
                                                                                         "templateLink":    {
                                                                                                                                    "uri":    "[concat(variables(\u0027deploymentUrlBase\u0027),\u0027app-service-certificate.json\u0027)]",
                                                                                                                                    "contentVersion":    "1.0.0.0"
                                                                                                                            },
                                                                                         "parameters":    {
                                                                                                                                "keyVaultCertificateName":    {
                                                                                                                                                                                                "value":    "[parameters(\u0027ProviderKeyvaultCertificateName\u0027)]"
                                                                                                                                                                                        },
                                                                                                                                "keyVaultName":    {
                                                                                                                                                                         "value":    "[parameters(\u0027sharedKeyvaultName\u0027)]"
                                                                                                                                                                 },
                                                                                                                                "keyVaultResourceGroup":    {
                                                                                                                                                                                            "value":    "[parameters(\u0027sharedManagementResourceGroup\u0027)]"
                                                                                                                                                                                    }
                                                                                                                        }
                                                                                 }
                                            },
                                            {
                                                    "apiVersion":    "2020-10-01",
                                                    "name":    "[concat(\u0027provider-recruit-app-service-\u0027, parameters(\u0027utcValue\u0027))]",
                                                    "type":    "Microsoft.Resources/deployments",
                                                    "resourceGroup":    "[variables(\u0027resourceGroupName\u0027)]",
                                                    "properties":    {
                                                                                         "mode":    "Incremental",
                                                                                         "templateLink":    {
                                                                                                                                    "uri":    "[concat(variables(\u0027deploymentUrlBase\u0027),\u0027app-service-v2.json\u0027)]",
                                                                                                                                    "contentVersion":    "1.0.0.0"
                                                                                                                            },
                                                                                         "parameters":    {
                                                                                                                                "appServiceName":    {
                                                                                                                                                                             "value":    "[variables(\u0027providerRecruitAppServiceName\u0027)]"
                                                                                                                                                                     },
                                                                                                                                "appServicePlanName":    {
                                                                                                                                                                                     "value":    "[parameters(\u0027sharedFrontEndAppServicePlanName\u0027)]"
                                                                                                                                                                             },
                                                                                                                                "appServicePlanResourceGroup":    {
                                                                                                                                                                                                        "value":    "[parameters(\u0027sharedEnvResourceGroup\u0027)]"
                                                                                                                                                                                                },
                                                                                                                                "subnetResourceId":    {
                                                                                                                                                                                 "value":    "[parameters(\u0027sharedFrontEndSubnetResourceId\u0027)]"
                                                                                                                                                                         },
                                                                                                                                "appServiceAppSettings":    {
                                                                                                                                                                                            "value":    {
                                                                                                                                                                                                                        "array":    [
                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                            "name":    "ConfigurationStorageConnectionString",
                                                                                                                                                                                                                                                            "value":    "[parameters(\u0027configurationStorageConnectionString\u0027)]"
                                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                            "name":    "APPLICATIONINSIGHTS_CONNECTION_STRING",
                                                                                                                                                                                                                                                            "value":    "[reference(concat(\u0027provider-recruit-app-insights-\u0027, parameters(\u0027utcValue\u0027))).outputs.ConnectionString.value]"
                                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                            "name":    "ResourceEnvironmentName",
                                                                                                                                                                                                                                                            "value":    "[toUpper(parameters(\u0027resourceEnvironmentName\u0027))]"
                                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                            "name":    "Environment",
                                                                                                                                                                                                                                                            "value":    "[toUpper(parameters(\u0027environmentName\u0027))]"
                                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                            "name":    "LoggingRedisConnectionString",
                                                                                                                                                                                                                                                            "value":    "[parameters(\u0027loggingRedisConnectionString\u0027)]"
                                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                            "name":    "Cdn:Url",
                                                                                                                                                                                                                                                            "value":    "[parameters(\u0027cdnUrl\u0027)]"
                                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                            "name":    "ConfigNames",
                                                                                                                                                                                                                                                            "value":    "[variables(\u0027providerWebConfigNames\u0027)]"
                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                            ]
                                                                                                                                                                                                                }
                                                                                                                                                                                    },
                                                                                                                                "customHostName":    {
                                                                                                                                                                             "value":    "[parameters(\u0027ProviderCustomHostname\u0027)]"
                                                                                                                                                                     },
                                                                                                                                "certificateThumbprint":    {
                                                                                                                                                                                            "value":    "[if(greater(length(parameters(\u0027ProviderCustomHostname\u0027)), 0), reference(concat(\u0027provider-recruit-app-service-certificate-\u0027, parameters(\u0027utcValue\u0027)), \u00272018-11-01\u0027).outputs.certificateThumbprint.value, \u0027\u0027)]"
                                                                                                                                                                                    },
                                                                                                                                "ipSecurityRestrictions":    {
                                                                                                                                                                                             "value":    "[parameters(\u0027frontEndAccessRestrictions\u0027)]"
                                                                                                                                                                                     }
                                                                                                                        }
                                                                                 }
                                            },
                                            {
                                                    "apiVersion":    "2020-10-01",
                                                    "name":    "[concat(\u0027storage-account-\u0027, parameters(\u0027utcValue\u0027))]",
                                                    "type":    "Microsoft.Resources/deployments",
                                                    "resourceGroup":    "[variables(\u0027resourceGroupName\u0027)]",
                                                    "properties":    {
                                                                                         "mode":    "Incremental",
                                                                                         "templateLink":    {
                                                                                                                                    "uri":    "[concat(variables(\u0027deploymentUrlBase\u0027),\u0027storage-account-arm.json\u0027)]",
                                                                                                                                    "contentVersion":    "1.0.0.0"
                                                                                                                            },
                                                                                         "parameters":    {
                                                                                                                                "storageAccountName":    {
                                                                                                                                                                                     "value":    "[variables(\u0027storageAccountName\u0027)]"
                                                                                                                                                                             },
                                                                                                                                "allowSharedKeyAccess":    {
                                                                                                                                                                                         "value":    true
                                                                                                                                                                                 },
                                                                                                                                "minimumTlsVersion":    {
                                                                                                                                                                                    "value":    "[parameters(\u0027minimumTlsVersion\u0027)]"
                                                                                                                                                                            }
                                                                                                                        }
                                                                                 },
                                                    "dependsOn":    [
                                                                                        "[variables(\u0027resourceGroupName\u0027)]"
                                                                                ]
                                            },
                                            {
                                                    "apiVersion":    "2020-10-01",
                                                    "name":    "[concat(\u0027webjob-app-service-plan-\u0027, parameters(\u0027utcValue\u0027))]",
                                                    "type":    "Microsoft.Resources/deployments",
                                                    "resourceGroup":    "[variables(\u0027resourceGroupName\u0027)]",
                                                    "properties":    {
                                                                                         "mode":    "Incremental",
                                                                                         "templateLink":    {
                                                                                                                                    "uri":    "[concat(variables(\u0027deploymentUrlBase\u0027),\u0027app-service-plan.json\u0027)]",
                                                                                                                                    "contentVersion":    "1.0.0.0"
                                                                                                                            },
                                                                                         "parameters":    {
                                                                                                                                "appServicePlanName":    {
                                                                                                                                                                                     "value":    "[variables(\u0027webJobAppServicePlanName\u0027)]"
                                                                                                                                                                             },
                                                                                                                                "aspSize":    {
                                                                                                                                                                "value":    "[parameters(\u0027jobsAspSize\u0027)]"
                                                                                                                                                        },
                                                                                                                                "aspInstances":    {
                                                                                                                                                                         "value":    "[parameters(\u0027jobsAspInstances\u0027)]"
                                                                                                                                                                 },
                                                                                                                                "nonASETier":    {
                                                                                                                                                                     "value":    "[parameters(\u0027jobsAspTier\u0027)]"
                                                                                                                                                             }
                                                                                                                        }
                                                                                 },
                                                    "dependsOn":    [
                                                                                        "[variables(\u0027resourceGroupName\u0027)]"
                                                                                ]
                                            },
                                            {
                                                    "type":    "Microsoft.Resources/deployments",
                                                    "apiVersion":    "2020-10-01",
                                                    "name":    "[concat(\u0027recruit-worker-subnet-\u0027, parameters(\u0027utcValue\u0027))]",
                                                    "resourceGroup":    "[parameters(\u0027sharedEnvResourceGroup\u0027)]",
                                                    "properties":    {
                                                                                         "mode":    "Incremental",
                                                                                         "templateLink":    {
                                                                                                                                    "uri":    "[concat(variables(\u0027deploymentUrlBase\u0027),\u0027subnet.json\u0027)]",
                                                                                                                                    "contentVersion":    "1.0.0.0"
                                                                                                                            },
                                                                                         "parameters":    {
                                                                                                                                "virtualNetworkName":    {
                                                                                                                                                                                     "value":    "[parameters(\u0027sharedEnvVirtualNetworkName\u0027)]"
                                                                                                                                                                             },
                                                                                                                                "subnetName":    {
                                                                                                                                                                     "value":    "[parameters(\u0027webjobSubnetObject\u0027).name]"
                                                                                                                                                             },
                                                                                                                                "subnetAddressPrefix":    {
                                                                                                                                                                                        "value":    "[parameters(\u0027webjobSubnetObject\u0027).addressSpace]"
                                                                                                                                                                                },
                                                                                                                                "serviceEndpointList":    {
                                                                                                                                                                                        "value":    "[parameters(\u0027subnetServiceEndpointList\u0027)]"
                                                                                                                                                                                },
                                                                                                                                "delegations":    {
                                                                                                                                                                        "value":    "[parameters(\u0027subnetDelegations\u0027)]"
                                                                                                                                                                },
                                                                                                                                "routeTable":    {
                                                                                                                                                                     "value":    "[if(parameters(\u0027enableRouteTableAssociation\u0027), variables(\u0027routeTableId\u0027) , variables(\u0027emptyObject\u0027))]"
                                                                                                                                                             }
                                                                                                                        }
                                                                                 }
                                            },
                                            {
                                                    "apiVersion":    "2021-04-01",
                                                    "name":    "[concat(\u0027recruit-worker-sql-firewall-rule-\u0027, parameters(\u0027utcValue\u0027))]",
                                                    "resourceGroup":    "[parameters(\u0027sharedEnvResourceGroup\u0027)]",
                                                    "type":    "Microsoft.Resources/deployments",
                                                    "properties":    {
                                                                                         "mode":    "Incremental",
                                                                                         "templateLink":    {
                                                                                                                                    "uri":    "[concat(variables(\u0027deploymentUrlBase\u0027), \u0027sql-server-firewall-rules.json\u0027)]",
                                                                                                                                    "contentVersion":    "1.0.0.0"
                                                                                                                            },
                                                                                         "parameters":    {
                                                                                                                                "serverName":    {
                                                                                                                                                                     "value":    "[parameters(\u0027sharedSQLServerName\u0027)]"
                                                                                                                                                             },
                                                                                                                                "subnetResourceIdList":    {
                                                                                                                                                                                         "value":    "[createArray(reference(concat(\u0027recruit-worker-subnet-\u0027, parameters(\u0027utcValue\u0027))).outputs.SubnetResourceId.value)]"
                                                                                                                                                                                 }
                                                                                                                        }
                                                                                 }
                                            },
                                            {
                                                    "apiVersion":    "2020-10-01",
                                                    "name":    "[concat(\u0027webjob-apim-product-subscription-\u0027, parameters(\u0027utcValue\u0027))]",
                                                    "resourceGroup":    "[parameters(\u0027sharedApimResourceGroup\u0027)]",
                                                    "type":    "Microsoft.Resources/deployments",
                                                    "properties":    {
                                                                                         "mode":    "Incremental",
                                                                                         "templateLink":    {
                                                                                                                                    "uri":    "[concat(variables(\u0027deploymentUrlBase\u0027),\u0027apim/apim-subscription.json\u0027)]",
                                                                                                                                    "contentVersion":    "1.0.0.0"
                                                                                                                            },
                                                                                         "parameters":    {
                                                                                                                                "apimName":    {
                                                                                                                                                                 "value":    "[parameters(\u0027sharedApimName\u0027)]"
                                                                                                                                                         },
                                                                                                                                "subscriptionName":    {
                                                                                                                                                                                 "value":    "[variables(\u0027webjobAppServiceName\u0027)]"
                                                                                                                                                                         },
                                                                                                                                "subscriptionScope":    {
                                                                                                                                                                                    "value":    "[concat(\u0027/subscriptions/\u0027, subscription().subscriptionId, \u0027/resourceGroups/\u0027, parameters(\u0027sharedApimResourceGroup\u0027), \u0027/providers/Microsoft.ApiManagement/service/\u0027, parameters(\u0027sharedApimName\u0027), \u0027/products/RecruitOuterApi\u0027)]"
                                                                                                                                                                            }
                                                                                                                        }
                                                                                 }
                                            },
                                            {
                                                    "apiVersion":    "2020-10-01",
                                                    "name":    "[concat(\u0027webjob-app-service-\u0027, parameters(\u0027utcValue\u0027))]",
                                                    "type":    "Microsoft.Resources/deployments",
                                                    "resourceGroup":    "[variables(\u0027resourceGroupName\u0027)]",
                                                    "properties":    {
                                                                                         "mode":    "Incremental",
                                                                                         "templateLink":    {
                                                                                                                                    "uri":    "[concat(variables(\u0027deploymentUrlBase\u0027),\u0027app-service-v2.json\u0027)]",
                                                                                                                                    "contentVersion":    "1.0.0.0"
                                                                                                                            },
                                                                                         "parameters":    {
                                                                                                                                "appServiceName":    {
                                                                                                                                                                             "value":    "[variables(\u0027webjobAppServiceName\u0027)]"
                                                                                                                                                                     },
                                                                                                                                "appServicePlanName":    {
                                                                                                                                                                                     "value":    "[variables(\u0027webJobAppServicePlanName\u0027)]"
                                                                                                                                                                             },
                                                                                                                                "appServicePlanResourceGroup":    {
                                                                                                                                                                                                        "value":    "[variables(\u0027resourcegroupName\u0027)]"
                                                                                                                                                                                                },
                                                                                                                                "subnetResourceId":    {
                                                                                                                                                                                 "value":    "[reference(concat(\u0027recruit-worker-subnet-\u0027, parameters(\u0027utcValue\u0027))).outputs.subnetResourceId.value]"
                                                                                                                                                                         },
                                                                                                                                "appServiceAppSettings":    {
                                                                                                                                                                                            "value":    {
                                                                                                                                                                                                                        "array":    [
                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                            "name":    "ConfigurationStorageConnectionString",
                                                                                                                                                                                                                                                            "value":    "[parameters(\u0027configurationStorageConnectionString\u0027)]"
                                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                            "name":    "Environment",
                                                                                                                                                                                                                                                            "value":    "[toUpper(parameters(\u0027environmentName\u0027))]"
                                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                            "name":    "LoggingRedisConnectionString",
                                                                                                                                                                                                                                                            "value":    "[parameters(\u0027loggingRedisConnectionString\u0027)]"
                                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                            "name":    "ConfigNames",
                                                                                                                                                                                                                                                            "value":    "[variables(\u0027jobsConfigNames\u0027)]"
                                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                            "name":    "APPLICATIONINSIGHTS_CONNECTION_STRING",
                                                                                                                                                                                                                                                            "value":    "[reference(concat(\u0027webjob-recruit-app-insights-\u0027, parameters(\u0027utcValue\u0027))).outputs.ConnectionString.value]"
                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                            ]
                                                                                                                                                                                                                }
                                                                                                                                                                                    },
                                                                                                                                "deployStagingSlot":    {
                                                                                                                                                                                    "value":    false
                                                                                                                                                                            },
                                                                                                                                "appServiceVirtualApplications":    {
                                                                                                                                                                                                            "value":    [
                                                                                                                                                                                                                                        {
                                                                                                                                                                                                                                                "virtualPath":    "/",
                                                                                                                                                                                                                                                "physicalPath":    "site\\wwwroot",
                                                                                                                                                                                                                                                "preloadEnabled":    true
                                                                                                                                                                                                                                        },
                                                                                                                                                                                                                                        {
                                                                                                                                                                                                                                                "virtualPath":    "/Recruit.Vacancies.Jobs",
                                                                                                                                                                                                                                                "physicalPath":    "site\\wwwroot\\app_data\\jobs\\continuous\\Recruit.Vacancies.Jobs",
                                                                                                                                                                                                                                                "preloadEnabled":    false
                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                ]
                                                                                                                                                                                                    },
                                                                                                                                "ipSecurityRestrictions":    {
                                                                                                                                                                                             "value":    "[parameters(\u0027workerAccessRestrictions\u0027)]"
                                                                                                                                                                                     }
                                                                                                                        }
                                                                                 },
                                                    "dependsOn":    [
                                                                                        "[concat(\u0027webjob-app-service-plan-\u0027, parameters(\u0027utcValue\u0027))]",
                                                                                        "[concat(\u0027webjob-apim-product-subscription-\u0027, parameters(\u0027utcValue\u0027))]"
                                                                                ]
                                            },
                                            {
                                                    "apiVersion":    "2020-06-01",
                                                    "name":    "[concat(\u0027webjob-servicebus-role-assignments-\u0027, parameters(\u0027utcValue\u0027))]",
                                                    "type":    "Microsoft.Resources/deployments",
                                                    "resourceGroup":    "[parameters(\u0027sharedEnvResourceGroup\u0027)]",
                                                    "properties":    {
                                                                                         "mode":    "Incremental",
                                                                                         "templateLink":    {
                                                                                                                                    "uri":    "[concat(variables(\u0027deploymentUrlBase\u0027),\u0027role-assignments/role-assignment-service-bus.json\u0027)]",
                                                                                                                                    "contentVersion":    "1.0.0.0"
                                                                                                                            },
                                                                                         "parameters":    {
                                                                                                                                "principalId":    {
                                                                                                                                                                        "value":    "[reference(concat(\u0027webjob-app-service-\u0027, parameters(\u0027utcValue\u0027))).outputs.managedServiceIdentityId.value]"
                                                                                                                                                                },
                                                                                                                                "assignmentType":    {
                                                                                                                                                                             "value":    "ServiceBusOwner"
                                                                                                                                                                     },
                                                                                                                                "resourceName":    {
                                                                                                                                                                         "value":    "[parameters(\u0027sharedServiceBusName\u0027)]"
                                                                                                                                                                 }
                                                                                                                        }
                                                                                 }
                                            },
                                            {
                                                    "apiVersion":    "2020-10-01",
                                                    "name":    "[concat(\u0027recruit-api-app-service-certificate-\u0027, parameters(\u0027utcValue\u0027))]",
                                                    "type":    "Microsoft.Resources/deployments",
                                                    "resourceGroup":    "[parameters(\u0027sharedEnvResourceGroup\u0027)]",
                                                    "properties":    {
                                                                                         "mode":    "Incremental",
                                                                                         "templateLink":    {
                                                                                                                                    "uri":    "[concat(variables(\u0027deploymentUrlBase\u0027),\u0027app-service-certificate.json\u0027)]",
                                                                                                                                    "contentVersion":    "1.0.0.0"
                                                                                                                            },
                                                                                         "parameters":    {
                                                                                                                                "keyVaultCertificateName":    {
                                                                                                                                                                                                "value":    "[parameters(\u0027apiKeyvaultCertificateName\u0027)]"
                                                                                                                                                                                        },
                                                                                                                                "keyVaultName":    {
                                                                                                                                                                         "value":    "[parameters(\u0027sharedKeyVaultName\u0027)]"
                                                                                                                                                                 },
                                                                                                                                "keyVaultResourceGroup":    {
                                                                                                                                                                                            "value":    "[parameters(\u0027sharedManagementResourceGroup\u0027)]"
                                                                                                                                                                                    }
                                                                                                                        }
                                                                                 }
                                            },
                                            {
                                                    "apiVersion":    "2020-10-01",
                                                    "name":    "[concat(\u0027api-application-insights-\u0027, parameters(\u0027utcValue\u0027))]",
                                                    "type":    "Microsoft.Resources/deployments",
                                                    "resourceGroup":    "[variables(\u0027resourceGroupName\u0027)]",
                                                    "properties":    {
                                                                                         "mode":    "Incremental",
                                                                                         "templateLink":    {
                                                                                                                                    "uri":    "[concat(variables(\u0027deploymentUrlBase\u0027),\u0027application-insights.json\u0027)]",
                                                                                                                                    "contentVersion":    "1.0.0.0"
                                                                                                                            },
                                                                                         "parameters":    {
                                                                                                                                "appInsightsName":    {
                                                                                                                                                                                "value":    "[variables(\u0027apiAppServiceName\u0027)]"
                                                                                                                                                                        },
                                                                                                                                "attachedService":    {
                                                                                                                                                                                "value":    "[variables(\u0027apiAppServiceName\u0027)]"
                                                                                                                                                                        },
                                                                                                                                "logAnalyticsWorkspaceId":    {
                                                                                                                                                                                                "value":    "[resourceId(parameters(\u0027logAnalyticsSubscriptionId\u0027),parameters(\u0027sharedManagementResourceGroup\u0027),\u0027Microsoft.OperationalInsights/workspaces\u0027,parameters(\u0027logAnalyticsWorkspaceName\u0027))]"
                                                                                                                                                                                        }
                                                                                                                        }
                                                                                 },
                                                    "dependsOn":    [
                                                                                        "[variables(\u0027resourceGroupName\u0027)]"
                                                                                ]
                                            },
                                            {
                                                    "apiVersion":    "2020-10-01",
                                                    "name":    "[concat(\u0027api-app-service-\u0027, parameters(\u0027utcValue\u0027))]",
                                                    "type":    "Microsoft.Resources/deployments",
                                                    "resourceGroup":    "[variables(\u0027resourceGroupName\u0027)]",
                                                    "properties":    {
                                                                                         "mode":    "Incremental",
                                                                                         "templateLink":    {
                                                                                                                                    "uri":    "[concat(variables(\u0027deploymentUrlBase\u0027),\u0027app-service-v2.json\u0027)]",
                                                                                                                                    "contentVersion":    "1.0.0.0"
                                                                                                                            },
                                                                                         "parameters":    {
                                                                                                                                "appServiceName":    {
                                                                                                                                                                             "value":    "[variables(\u0027apiAppServiceName\u0027)]"
                                                                                                                                                                     },
                                                                                                                                "appServicePlanName":    {
                                                                                                                                                                                     "value":    "[parameters(\u0027sharedBackEndAppServicePlanName\u0027)]"
                                                                                                                                                                             },
                                                                                                                                "appServicePlanResourceGroup":    {
                                                                                                                                                                                                        "value":    "[parameters(\u0027sharedEnvResourceGroup\u0027)]"
                                                                                                                                                                                                },
                                                                                                                                "subnetResourceId":    {
                                                                                                                                                                                 "value":    "[parameters(\u0027sharedBackEndSubnetResourceId\u0027)]"
                                                                                                                                                                         },
                                                                                                                                "appServiceAppSettings":    {
                                                                                                                                                                                            "value":    {
                                                                                                                                                                                                                        "array":    [
                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                            "name":    "ConfigurationStorageConnectionString",
                                                                                                                                                                                                                                                            "value":    "[parameters(\u0027configurationStorageConnectionString\u0027)]"
                                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                            "name":    "APPLICATIONINSIGHTS_CONNECTION_STRING",
                                                                                                                                                                                                                                                            "value":    "[reference(concat(\u0027api-application-insights-\u0027, parameters(\u0027utcValue\u0027))).outputs.ConnectionString.value]"
                                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                            "name":    "Environment",
                                                                                                                                                                                                                                                            "value":    "[toUpper(parameters(\u0027environmentName\u0027))]"
                                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                            "name":    "LoggingRedisConnectionString",
                                                                                                                                                                                                                                                            "value":    "[parameters(\u0027loggingRedisConnectionString\u0027)]"
                                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                            "name":    "ConfigNames",
                                                                                                                                                                                                                                                            "value":    "[variables(\u0027apiConfigNames\u0027)]"
                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                            ]
                                                                                                                                                                                                                }
                                                                                                                                                                                    },
                                                                                                                                "customHostName":    {
                                                                                                                                                                             "value":    "[parameters(\u0027apiCustomHostname\u0027)]"
                                                                                                                                                                     },
                                                                                                                                "certificateThumbprint":    {
                                                                                                                                                                                            "value":    "[reference(concat(\u0027recruit-api-app-service-certificate-\u0027, parameters(\u0027utcValue\u0027))).outputs.certificateThumbprint.value]"
                                                                                                                                                                                    },
                                                                                                                                "ipSecurityRestrictions":    {
                                                                                                                                                                                             "value":    "[parameters(\u0027wafOutboundIPAddresses\u0027)]"
                                                                                                                                                                                     }
                                                                                                                        }
                                                                                 }
                                            }
                                    ],
        "outputs":    {
                                        "ResourceGroupName":    {
                                                                                            "type":    "string",
                                                                                            "value":    "[variables(\u0027resourceGroupName\u0027)]"
                                                                                    },
                                        "EmployerAppServiceName":    {
                                                                                                     "type":    "string",
                                                                                                     "value":    "[variables(\u0027employerRecruitAppServiceName\u0027)]"
                                                                                             },
                                        "ProviderAppServiceName":    {
                                                                                                     "type":    "string",
                                                                                                     "value":    "[variables(\u0027providerRecruitAppServiceName\u0027)]"
                                                                                             },
                                        "QAAppServiceName":    {
                                                                                         "type":    "string",
                                                                                         "value":    "[variables(\u0027qaAppServiceName\u0027)]"
                                                                                 },
                                        "JobsAppServiceName":    {
                                                                                             "type":    "string",
                                                                                             "value":    "[variables(\u0027webjobAppServiceName\u0027)]"
                                                                                     },
                                        "ApiAppServiceName":    {
                                                                                            "type":    "string",
                                                                                            "value":    "[variables(\u0027apiAppServiceName\u0027)]"
                                                                                    },
                                        "StorageAccountName":    {
                                                                                             "type":    "string",
                                                                                             "value":    "[variables(\u0027storageAccountName\u0027)]"
                                                                                     }
                                }
}
